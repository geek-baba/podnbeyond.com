"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/jwt */ \"(middleware)/./node_modules/next-auth/jwt/index.js\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__);\n\n\n// Define which roles can access admin routes\nconst ADMIN_ROLES = [\n    \"SUPERADMIN\",\n    \"ADMIN\",\n    \"MANAGER\",\n    \"STAFF_FRONTDESK\",\n    \"STAFF_OPS\"\n];\nasync function middleware(request) {\n    const { pathname } = request.nextUrl;\n    // Protect /admin routes (except login pages)\n    if (pathname.startsWith(\"/admin\")) {\n        // Allow login, logout, verify pages\n        if (pathname === \"/admin/login\" || pathname === \"/admin/logout\" || pathname === \"/admin/verify-email\" || pathname === \"/admin/forbidden\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n        }\n        // Get session token\n        const token = await (0,next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__.getToken)({\n            req: request,\n            secret: process.env.NEXTAUTH_SECRET\n        });\n        // Not authenticated - redirect to login\n        if (!token) {\n            const url = new URL(\"/admin/login\", request.url);\n            url.searchParams.set(\"callbackUrl\", pathname);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(url);\n        }\n        // Check if user has admin-level role\n        // Note: In JWT strategy, roles are in token.roles from the JWT callback\n        const userRoles = token.roles || [];\n        // If roles array exists and has entries, check them\n        let hasAdminRole = false;\n        if (Array.isArray(userRoles) && userRoles.length > 0) {\n            hasAdminRole = userRoles.some((role)=>ADMIN_ROLES.includes(role.key || role.roleKey));\n        } else {\n            // Fallback: Check if user email is a known superadmin\n            const superadminEmails = [\n                \"admin@podnbeyond.com\",\n                \"shwet@thedesi.email\"\n            ];\n            const isSuperadmin = superadminEmails.includes(token.email);\n            hasAdminRole = isSuperadmin;\n        }\n        if (!hasAdminRole) {\n            // User is authenticated but doesn't have admin access\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/forbidden\", request.url));\n        }\n        // Authorized - proceed\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Protect /account routes (member area)\n    if (pathname.startsWith(\"/account\")) {\n        const token = await (0,next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__.getToken)({\n            req: request,\n            secret: process.env.NEXTAUTH_SECRET\n        });\n        if (!token) {\n            const url = new URL(\"/admin/login\", request.url);\n            url.searchParams.set(\"callbackUrl\", pathname);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(url);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\nconst config = {\n    matcher: [\n        \"/admin/:path*\",\n        \"/account/:path*\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUEyQztBQUVGO0FBRXpDLDZDQUE2QztBQUM3QyxNQUFNRSxjQUFjO0lBQUM7SUFBYztJQUFTO0lBQVc7SUFBbUI7Q0FBWTtBQUUvRSxlQUFlQyxXQUFXQyxPQUFvQjtJQUNuRCxNQUFNLEVBQUVDLFFBQVEsRUFBRSxHQUFHRCxRQUFRRSxPQUFPO0lBRXBDLDZDQUE2QztJQUM3QyxJQUFJRCxTQUFTRSxVQUFVLENBQUMsV0FBVztRQUNqQyxvQ0FBb0M7UUFDcEMsSUFDRUYsYUFBYSxrQkFDYkEsYUFBYSxtQkFDYkEsYUFBYSx5QkFDYkEsYUFBYSxvQkFDYjtZQUNBLE9BQU9MLHFEQUFZQSxDQUFDUSxJQUFJO1FBQzFCO1FBRUEsb0JBQW9CO1FBQ3BCLE1BQU1DLFFBQVEsTUFBTVIsdURBQVFBLENBQUM7WUFDM0JTLEtBQUtOO1lBQ0xPLFFBQVFDLFFBQVFDLEdBQUcsQ0FBQ0MsZUFBZTtRQUNyQztRQUVBLHdDQUF3QztRQUN4QyxJQUFJLENBQUNMLE9BQU87WUFDVixNQUFNTSxNQUFNLElBQUlDLElBQUksZ0JBQWdCWixRQUFRVyxHQUFHO1lBQy9DQSxJQUFJRSxZQUFZLENBQUNDLEdBQUcsQ0FBQyxlQUFlYjtZQUNwQyxPQUFPTCxxREFBWUEsQ0FBQ21CLFFBQVEsQ0FBQ0o7UUFDL0I7UUFFQSxxQ0FBcUM7UUFDckMsd0VBQXdFO1FBQ3hFLE1BQU1LLFlBQVksTUFBZUMsS0FBSyxJQUFJLEVBQUU7UUFFNUMsb0RBQW9EO1FBQ3BELElBQUlDLGVBQWU7UUFDbkIsSUFBSUMsTUFBTUMsT0FBTyxDQUFDSixjQUFjQSxVQUFVSyxNQUFNLEdBQUcsR0FBRztZQUNwREgsZUFBZUYsVUFBVU0sSUFBSSxDQUFDLENBQUNDLE9BQzdCekIsWUFBWTBCLFFBQVEsQ0FBQ0QsS0FBS0UsR0FBRyxJQUFJRixLQUFLRyxPQUFPO1FBRWpELE9BQU87WUFDTCxzREFBc0Q7WUFDdEQsTUFBTUMsbUJBQW1CO2dCQUFDO2dCQUF3QjthQUFzQjtZQUN4RSxNQUFNQyxlQUFlRCxpQkFBaUJILFFBQVEsQ0FBQ25CLE1BQU13QixLQUFLO1lBQzFEWCxlQUFlVTtRQUNqQjtRQUVBLElBQUksQ0FBQ1YsY0FBYztZQUNqQixzREFBc0Q7WUFDdEQsT0FBT3RCLHFEQUFZQSxDQUFDbUIsUUFBUSxDQUFDLElBQUlILElBQUksb0JBQW9CWixRQUFRVyxHQUFHO1FBQ3RFO1FBRUEsdUJBQXVCO1FBQ3ZCLE9BQU9mLHFEQUFZQSxDQUFDUSxJQUFJO0lBQzFCO0lBRUEsd0NBQXdDO0lBQ3hDLElBQUlILFNBQVNFLFVBQVUsQ0FBQyxhQUFhO1FBQ25DLE1BQU1FLFFBQVEsTUFBTVIsdURBQVFBLENBQUM7WUFDM0JTLEtBQUtOO1lBQ0xPLFFBQVFDLFFBQVFDLEdBQUcsQ0FBQ0MsZUFBZTtRQUNyQztRQUVBLElBQUksQ0FBQ0wsT0FBTztZQUNWLE1BQU1NLE1BQU0sSUFBSUMsSUFBSSxnQkFBZ0JaLFFBQVFXLEdBQUc7WUFDL0NBLElBQUlFLFlBQVksQ0FBQ0MsR0FBRyxDQUFDLGVBQWViO1lBQ3BDLE9BQU9MLHFEQUFZQSxDQUFDbUIsUUFBUSxDQUFDSjtRQUMvQjtRQUVBLE9BQU9mLHFEQUFZQSxDQUFDUSxJQUFJO0lBQzFCO0lBRUEsT0FBT1IscURBQVlBLENBQUNRLElBQUk7QUFDMUI7QUFFTyxNQUFNMEIsU0FBUztJQUNwQkMsU0FBUztRQUNQO1FBQ0E7S0FDRDtBQUNILEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbWlkZGxld2FyZS50cz80MjJkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB0eXBlIHsgTmV4dFJlcXVlc3QgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBnZXRUb2tlbiB9IGZyb20gJ25leHQtYXV0aC9qd3QnO1xuXG4vLyBEZWZpbmUgd2hpY2ggcm9sZXMgY2FuIGFjY2VzcyBhZG1pbiByb3V0ZXNcbmNvbnN0IEFETUlOX1JPTEVTID0gWydTVVBFUkFETUlOJywgJ0FETUlOJywgJ01BTkFHRVInLCAnU1RBRkZfRlJPTlRERVNLJywgJ1NUQUZGX09QUyddO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWlkZGxld2FyZShyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCB7IHBhdGhuYW1lIH0gPSByZXF1ZXN0Lm5leHRVcmw7XG5cbiAgLy8gUHJvdGVjdCAvYWRtaW4gcm91dGVzIChleGNlcHQgbG9naW4gcGFnZXMpXG4gIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYWRtaW4nKSkge1xuICAgIC8vIEFsbG93IGxvZ2luLCBsb2dvdXQsIHZlcmlmeSBwYWdlc1xuICAgIGlmIChcbiAgICAgIHBhdGhuYW1lID09PSAnL2FkbWluL2xvZ2luJyB8fFxuICAgICAgcGF0aG5hbWUgPT09ICcvYWRtaW4vbG9nb3V0JyB8fFxuICAgICAgcGF0aG5hbWUgPT09ICcvYWRtaW4vdmVyaWZ5LWVtYWlsJyB8fFxuICAgICAgcGF0aG5hbWUgPT09ICcvYWRtaW4vZm9yYmlkZGVuJ1xuICAgICkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG4gICAgfVxuXG4gICAgLy8gR2V0IHNlc3Npb24gdG9rZW5cbiAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGdldFRva2VuKHtcbiAgICAgIHJlcTogcmVxdWVzdCxcbiAgICAgIHNlY3JldDogcHJvY2Vzcy5lbnYuTkVYVEFVVEhfU0VDUkVULFxuICAgIH0pO1xuXG4gICAgLy8gTm90IGF1dGhlbnRpY2F0ZWQgLSByZWRpcmVjdCB0byBsb2dpblxuICAgIGlmICghdG9rZW4pIHtcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoJy9hZG1pbi9sb2dpbicsIHJlcXVlc3QudXJsKTtcbiAgICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KCdjYWxsYmFja1VybCcsIHBhdGhuYW1lKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QodXJsKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiB1c2VyIGhhcyBhZG1pbi1sZXZlbCByb2xlXG4gICAgLy8gTm90ZTogSW4gSldUIHN0cmF0ZWd5LCByb2xlcyBhcmUgaW4gdG9rZW4ucm9sZXMgZnJvbSB0aGUgSldUIGNhbGxiYWNrXG4gICAgY29uc3QgdXNlclJvbGVzID0gKHRva2VuIGFzIGFueSkucm9sZXMgfHwgW107XG4gICAgXG4gICAgLy8gSWYgcm9sZXMgYXJyYXkgZXhpc3RzIGFuZCBoYXMgZW50cmllcywgY2hlY2sgdGhlbVxuICAgIGxldCBoYXNBZG1pblJvbGUgPSBmYWxzZTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheSh1c2VyUm9sZXMpICYmIHVzZXJSb2xlcy5sZW5ndGggPiAwKSB7XG4gICAgICBoYXNBZG1pblJvbGUgPSB1c2VyUm9sZXMuc29tZSgocm9sZTogYW55KSA9PiBcbiAgICAgICAgQURNSU5fUk9MRVMuaW5jbHVkZXMocm9sZS5rZXkgfHwgcm9sZS5yb2xlS2V5KVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRmFsbGJhY2s6IENoZWNrIGlmIHVzZXIgZW1haWwgaXMgYSBrbm93biBzdXBlcmFkbWluXG4gICAgICBjb25zdCBzdXBlcmFkbWluRW1haWxzID0gWydhZG1pbkBwb2RuYmV5b25kLmNvbScsICdzaHdldEB0aGVkZXNpLmVtYWlsJ107XG4gICAgICBjb25zdCBpc1N1cGVyYWRtaW4gPSBzdXBlcmFkbWluRW1haWxzLmluY2x1ZGVzKHRva2VuLmVtYWlsIGFzIHN0cmluZyk7XG4gICAgICBoYXNBZG1pblJvbGUgPSBpc1N1cGVyYWRtaW47XG4gICAgfVxuXG4gICAgaWYgKCFoYXNBZG1pblJvbGUpIHtcbiAgICAgIC8vIFVzZXIgaXMgYXV0aGVudGljYXRlZCBidXQgZG9lc24ndCBoYXZlIGFkbWluIGFjY2Vzc1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvYWRtaW4vZm9yYmlkZGVuJywgcmVxdWVzdC51cmwpKTtcbiAgICB9XG5cbiAgICAvLyBBdXRob3JpemVkIC0gcHJvY2VlZFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xuICB9XG5cbiAgLy8gUHJvdGVjdCAvYWNjb3VudCByb3V0ZXMgKG1lbWJlciBhcmVhKVxuICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FjY291bnQnKSkge1xuICAgIGNvbnN0IHRva2VuID0gYXdhaXQgZ2V0VG9rZW4oe1xuICAgICAgcmVxOiByZXF1ZXN0LFxuICAgICAgc2VjcmV0OiBwcm9jZXNzLmVudi5ORVhUQVVUSF9TRUNSRVQsXG4gICAgfSk7XG5cbiAgICBpZiAoIXRva2VuKSB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKCcvYWRtaW4vbG9naW4nLCByZXF1ZXN0LnVybCk7XG4gICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgnY2FsbGJhY2tVcmwnLCBwYXRobmFtZSk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KHVybCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG4gIH1cblxuICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbn1cblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgbWF0Y2hlcjogW1xuICAgICcvYWRtaW4vOnBhdGgqJyxcbiAgICAnL2FjY291bnQvOnBhdGgqJyxcbiAgXSxcbn07XG5cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRUb2tlbiIsIkFETUlOX1JPTEVTIiwibWlkZGxld2FyZSIsInJlcXVlc3QiLCJwYXRobmFtZSIsIm5leHRVcmwiLCJzdGFydHNXaXRoIiwibmV4dCIsInRva2VuIiwicmVxIiwic2VjcmV0IiwicHJvY2VzcyIsImVudiIsIk5FWFRBVVRIX1NFQ1JFVCIsInVybCIsIlVSTCIsInNlYXJjaFBhcmFtcyIsInNldCIsInJlZGlyZWN0IiwidXNlclJvbGVzIiwicm9sZXMiLCJoYXNBZG1pblJvbGUiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJzb21lIiwicm9sZSIsImluY2x1ZGVzIiwia2V5Iiwicm9sZUtleSIsInN1cGVyYWRtaW5FbWFpbHMiLCJpc1N1cGVyYWRtaW4iLCJlbWFpbCIsImNvbmZpZyIsIm1hdGNoZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});