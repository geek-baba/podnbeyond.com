"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/jwt */ \"(middleware)/./node_modules/next-auth/jwt/index.js\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__);\n\n\n// Define which roles can access admin routes\nconst ADMIN_ROLES = [\n    \"SUPERADMIN\",\n    \"ADMIN\",\n    \"MANAGER\",\n    \"STAFF_FRONTDESK\",\n    \"STAFF_OPS\"\n];\nasync function middleware(request) {\n    const { pathname } = request.nextUrl;\n    // Protect /admin routes (except login pages)\n    if (pathname.startsWith(\"/admin\")) {\n        // Allow login, logout, verify pages\n        if (pathname === \"/admin/login\" || pathname === \"/admin/logout\" || pathname === \"/admin/verify-email\" || pathname === \"/admin/forbidden\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n        }\n        // Get session token\n        const token = await (0,next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__.getToken)({\n            req: request,\n            secret: process.env.NEXTAUTH_SECRET\n        });\n        // Not authenticated - redirect to login\n        if (!token) {\n            const url = new URL(\"/admin/login\", request.url);\n            url.searchParams.set(\"callbackUrl\", pathname);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(url);\n        }\n        // Check if user has admin-level role\n        // Note: In JWT strategy, roles are in token.roles from the JWT callback\n        const userRoles = token.roles || [];\n        // If roles array exists and has entries, check them\n        let hasAdminRole = false;\n        if (Array.isArray(userRoles) && userRoles.length > 0) {\n            hasAdminRole = userRoles.some((role)=>ADMIN_ROLES.includes(role.key || role.roleKey));\n        } else {\n            // Fallback: Check if user email is the bootstrap superadmin\n            const isSuperadmin = token.email === \"admin@podnbeyond.com\";\n            hasAdminRole = isSuperadmin;\n        }\n        if (!hasAdminRole) {\n            // User is authenticated but doesn't have admin access\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/forbidden\", request.url));\n        }\n        // Authorized - proceed\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Protect /account routes (member area)\n    if (pathname.startsWith(\"/account\")) {\n        const token = await (0,next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__.getToken)({\n            req: request,\n            secret: process.env.NEXTAUTH_SECRET\n        });\n        if (!token) {\n            const url = new URL(\"/admin/login\", request.url);\n            url.searchParams.set(\"callbackUrl\", pathname);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(url);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\nconst config = {\n    matcher: [\n        \"/admin/:path*\",\n        \"/account/:path*\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUEyQztBQUVGO0FBRXpDLDZDQUE2QztBQUM3QyxNQUFNRSxjQUFjO0lBQUM7SUFBYztJQUFTO0lBQVc7SUFBbUI7Q0FBWTtBQUUvRSxlQUFlQyxXQUFXQyxPQUFvQjtJQUNuRCxNQUFNLEVBQUVDLFFBQVEsRUFBRSxHQUFHRCxRQUFRRSxPQUFPO0lBRXBDLDZDQUE2QztJQUM3QyxJQUFJRCxTQUFTRSxVQUFVLENBQUMsV0FBVztRQUNqQyxvQ0FBb0M7UUFDcEMsSUFDRUYsYUFBYSxrQkFDYkEsYUFBYSxtQkFDYkEsYUFBYSx5QkFDYkEsYUFBYSxvQkFDYjtZQUNBLE9BQU9MLHFEQUFZQSxDQUFDUSxJQUFJO1FBQzFCO1FBRUEsb0JBQW9CO1FBQ3BCLE1BQU1DLFFBQVEsTUFBTVIsdURBQVFBLENBQUM7WUFDM0JTLEtBQUtOO1lBQ0xPLFFBQVFDLFFBQVFDLEdBQUcsQ0FBQ0MsZUFBZTtRQUNyQztRQUVBLHdDQUF3QztRQUN4QyxJQUFJLENBQUNMLE9BQU87WUFDVixNQUFNTSxNQUFNLElBQUlDLElBQUksZ0JBQWdCWixRQUFRVyxHQUFHO1lBQy9DQSxJQUFJRSxZQUFZLENBQUNDLEdBQUcsQ0FBQyxlQUFlYjtZQUNwQyxPQUFPTCxxREFBWUEsQ0FBQ21CLFFBQVEsQ0FBQ0o7UUFDL0I7UUFFQSxxQ0FBcUM7UUFDckMsd0VBQXdFO1FBQ3hFLE1BQU1LLFlBQVksTUFBZUMsS0FBSyxJQUFJLEVBQUU7UUFFNUMsb0RBQW9EO1FBQ3BELElBQUlDLGVBQWU7UUFDbkIsSUFBSUMsTUFBTUMsT0FBTyxDQUFDSixjQUFjQSxVQUFVSyxNQUFNLEdBQUcsR0FBRztZQUNwREgsZUFBZUYsVUFBVU0sSUFBSSxDQUFDLENBQUNDLE9BQzdCekIsWUFBWTBCLFFBQVEsQ0FBQ0QsS0FBS0UsR0FBRyxJQUFJRixLQUFLRyxPQUFPO1FBRWpELE9BQU87WUFDTCw0REFBNEQ7WUFDNUQsTUFBTUMsZUFBZXRCLE1BQU11QixLQUFLLEtBQUs7WUFDckNWLGVBQWVTO1FBQ2pCO1FBRUEsSUFBSSxDQUFDVCxjQUFjO1lBQ2pCLHNEQUFzRDtZQUN0RCxPQUFPdEIscURBQVlBLENBQUNtQixRQUFRLENBQUMsSUFBSUgsSUFBSSxvQkFBb0JaLFFBQVFXLEdBQUc7UUFDdEU7UUFFQSx1QkFBdUI7UUFDdkIsT0FBT2YscURBQVlBLENBQUNRLElBQUk7SUFDMUI7SUFFQSx3Q0FBd0M7SUFDeEMsSUFBSUgsU0FBU0UsVUFBVSxDQUFDLGFBQWE7UUFDbkMsTUFBTUUsUUFBUSxNQUFNUix1REFBUUEsQ0FBQztZQUMzQlMsS0FBS047WUFDTE8sUUFBUUMsUUFBUUMsR0FBRyxDQUFDQyxlQUFlO1FBQ3JDO1FBRUEsSUFBSSxDQUFDTCxPQUFPO1lBQ1YsTUFBTU0sTUFBTSxJQUFJQyxJQUFJLGdCQUFnQlosUUFBUVcsR0FBRztZQUMvQ0EsSUFBSUUsWUFBWSxDQUFDQyxHQUFHLENBQUMsZUFBZWI7WUFDcEMsT0FBT0wscURBQVlBLENBQUNtQixRQUFRLENBQUNKO1FBQy9CO1FBRUEsT0FBT2YscURBQVlBLENBQUNRLElBQUk7SUFDMUI7SUFFQSxPQUFPUixxREFBWUEsQ0FBQ1EsSUFBSTtBQUMxQjtBQUVPLE1BQU15QixTQUFTO0lBQ3BCQyxTQUFTO1FBQ1A7UUFDQTtLQUNEO0FBQ0gsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9taWRkbGV3YXJlLnRzPzQyMmQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHR5cGUgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAnbmV4dC1hdXRoL2p3dCc7XG5cbi8vIERlZmluZSB3aGljaCByb2xlcyBjYW4gYWNjZXNzIGFkbWluIHJvdXRlc1xuY29uc3QgQURNSU5fUk9MRVMgPSBbJ1NVUEVSQURNSU4nLCAnQURNSU4nLCAnTUFOQUdFUicsICdTVEFGRl9GUk9OVERFU0snLCAnU1RBRkZfT1BTJ107XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHsgcGF0aG5hbWUgfSA9IHJlcXVlc3QubmV4dFVybDtcblxuICAvLyBQcm90ZWN0IC9hZG1pbiByb3V0ZXMgKGV4Y2VwdCBsb2dpbiBwYWdlcylcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hZG1pbicpKSB7XG4gICAgLy8gQWxsb3cgbG9naW4sIGxvZ291dCwgdmVyaWZ5IHBhZ2VzXG4gICAgaWYgKFxuICAgICAgcGF0aG5hbWUgPT09ICcvYWRtaW4vbG9naW4nIHx8XG4gICAgICBwYXRobmFtZSA9PT0gJy9hZG1pbi9sb2dvdXQnIHx8XG4gICAgICBwYXRobmFtZSA9PT0gJy9hZG1pbi92ZXJpZnktZW1haWwnIHx8XG4gICAgICBwYXRobmFtZSA9PT0gJy9hZG1pbi9mb3JiaWRkZW4nXG4gICAgKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgICB9XG5cbiAgICAvLyBHZXQgc2Vzc2lvbiB0b2tlblxuICAgIGNvbnN0IHRva2VuID0gYXdhaXQgZ2V0VG9rZW4oe1xuICAgICAgcmVxOiByZXF1ZXN0LFxuICAgICAgc2VjcmV0OiBwcm9jZXNzLmVudi5ORVhUQVVUSF9TRUNSRVQsXG4gICAgfSk7XG5cbiAgICAvLyBOb3QgYXV0aGVudGljYXRlZCAtIHJlZGlyZWN0IHRvIGxvZ2luXG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTCgnL2FkbWluL2xvZ2luJywgcmVxdWVzdC51cmwpO1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ2NhbGxiYWNrVXJsJywgcGF0aG5hbWUpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdCh1cmwpO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHVzZXIgaGFzIGFkbWluLWxldmVsIHJvbGVcbiAgICAvLyBOb3RlOiBJbiBKV1Qgc3RyYXRlZ3ksIHJvbGVzIGFyZSBpbiB0b2tlbi5yb2xlcyBmcm9tIHRoZSBKV1QgY2FsbGJhY2tcbiAgICBjb25zdCB1c2VyUm9sZXMgPSAodG9rZW4gYXMgYW55KS5yb2xlcyB8fCBbXTtcbiAgICBcbiAgICAvLyBJZiByb2xlcyBhcnJheSBleGlzdHMgYW5kIGhhcyBlbnRyaWVzLCBjaGVjayB0aGVtXG4gICAgbGV0IGhhc0FkbWluUm9sZSA9IGZhbHNlO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHVzZXJSb2xlcykgJiYgdXNlclJvbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGhhc0FkbWluUm9sZSA9IHVzZXJSb2xlcy5zb21lKChyb2xlOiBhbnkpID0+IFxuICAgICAgICBBRE1JTl9ST0xFUy5pbmNsdWRlcyhyb2xlLmtleSB8fCByb2xlLnJvbGVLZXkpXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBGYWxsYmFjazogQ2hlY2sgaWYgdXNlciBlbWFpbCBpcyB0aGUgYm9vdHN0cmFwIHN1cGVyYWRtaW5cbiAgICAgIGNvbnN0IGlzU3VwZXJhZG1pbiA9IHRva2VuLmVtYWlsID09PSAnYWRtaW5AcG9kbmJleW9uZC5jb20nO1xuICAgICAgaGFzQWRtaW5Sb2xlID0gaXNTdXBlcmFkbWluO1xuICAgIH1cblxuICAgIGlmICghaGFzQWRtaW5Sb2xlKSB7XG4gICAgICAvLyBVc2VyIGlzIGF1dGhlbnRpY2F0ZWQgYnV0IGRvZXNuJ3QgaGF2ZSBhZG1pbiBhY2Nlc3NcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL2FkbWluL2ZvcmJpZGRlbicsIHJlcXVlc3QudXJsKSk7XG4gICAgfVxuXG4gICAgLy8gQXV0aG9yaXplZCAtIHByb2NlZWRcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgfVxuXG4gIC8vIFByb3RlY3QgL2FjY291bnQgcm91dGVzIChtZW1iZXIgYXJlYSlcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hY2NvdW50JykpIHtcbiAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGdldFRva2VuKHtcbiAgICAgIHJlcTogcmVxdWVzdCxcbiAgICAgIHNlY3JldDogcHJvY2Vzcy5lbnYuTkVYVEFVVEhfU0VDUkVULFxuICAgIH0pO1xuXG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTCgnL2FkbWluL2xvZ2luJywgcmVxdWVzdC51cmwpO1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ2NhbGxiYWNrVXJsJywgcGF0aG5hbWUpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdCh1cmwpO1xuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xuICB9XG5cbiAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG59XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIG1hdGNoZXI6IFtcbiAgICAnL2FkbWluLzpwYXRoKicsXG4gICAgJy9hY2NvdW50LzpwYXRoKicsXG4gIF0sXG59O1xuXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZ2V0VG9rZW4iLCJBRE1JTl9ST0xFUyIsIm1pZGRsZXdhcmUiLCJyZXF1ZXN0IiwicGF0aG5hbWUiLCJuZXh0VXJsIiwic3RhcnRzV2l0aCIsIm5leHQiLCJ0b2tlbiIsInJlcSIsInNlY3JldCIsInByb2Nlc3MiLCJlbnYiLCJORVhUQVVUSF9TRUNSRVQiLCJ1cmwiLCJVUkwiLCJzZWFyY2hQYXJhbXMiLCJzZXQiLCJyZWRpcmVjdCIsInVzZXJSb2xlcyIsInJvbGVzIiwiaGFzQWRtaW5Sb2xlIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwic29tZSIsInJvbGUiLCJpbmNsdWRlcyIsImtleSIsInJvbGVLZXkiLCJpc1N1cGVyYWRtaW4iLCJlbWFpbCIsImNvbmZpZyIsIm1hdGNoZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});